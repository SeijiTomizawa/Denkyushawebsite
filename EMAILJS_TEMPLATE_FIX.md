# EmailJS テンプレート修正ガイド - 電究社

## 🔴 問題

メールは送信されているが、入力内容が表示されない

```
お問い合わせがありました。

名前:
メールアドレス:
会社名・団体名:

お問い合わせ内容:
```

## ✅ 原因

EmailJSのテンプレートが古い変数名（お問い合わせフォーム専用）のままになっているため、お申し込みフォームのデータを受け取れていません。

---

## 🛠️ 修正手順

### ステップ1: EmailJSダッシュボードにアクセス

1. [EmailJS Dashboard](https://dashboard.emailjs.com/) にログイン
2. 左側メニューから **Email Templates** をクリック
3. テンプレート `template_vffjunb` をクリック

---

### ステップ2: テンプレートを更新

以下の内容でテンプレートを更新してください。

#### 📝 件名（Subject）

```
【電究社】{{form_type}} - {{person_name}}{{from_name}}様より
```

> **説明:** `{{person_name}}`（お申し込み用）と`{{from_name}}`（お問い合わせ用）の両方を記載することで、どちらのフォームでも対応できます。

---

#### 📝 本文（Content）

```html
電究社へ{{form_type}}がありました。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ フォームタイプ
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{{form_type}}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ 基本情報
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{{#company_name}}
【WEB制作お申し込み】
会社名・屋号: {{company_name}}
ご担当者名: {{person_name}}
メールアドレス: {{email}}
電話番号: {{phone}}
{{/company_name}}

{{#from_name}}
【お問い合わせ】
お名前: {{from_name}}
メールアドレス: {{from_email}}
会社名・団体名: {{company}}
{{/from_name}}

{{#company_name}}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ サイト情報
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
業種: {{industry}}

サイトの目的:
{{purpose}}

デザインイメージ: {{design_image}}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ ページ構成
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
必要なページ: {{pages}}
概算ページ数: {{page_count}}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ 機能要件
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
必要な機能: {{features}}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ 予算・スケジュール
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ご予算: {{budget}}
希望納期: {{deadline}}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ その他
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
参考サイト（URL）:
{{reference_urls}}

その他ご要望・ご質問:
{{other_requests}}
{{/company_name}}

{{#message}}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
■ お問い合わせ内容
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{{message}}
{{/message}}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━

このメールは電究社のフォームから自動送信されました。
送信日時: {{sent_at}}
```

---

### ステップ3: テンプレートを保存

1. **Save** ボタンをクリック
2. 保存が完了するのを待つ

---

### ステップ4: テスト送信

#### お問い合わせフォームをテスト

1. サイトのお問い合わせフォームからテストメッセージを送信
2. メールを確認
3. 以下が表示されているか確認：
   ```
   【電究社】お問い合わせ - ○○様より
   
   フォームタイプ: お問い合わせ
   
   【お問い合わせ】
   お名前: ○○
   メールアドレス: ○○
   会社名・団体名: ○○
   
   お問い合わせ内容:
   ○○○○○
   ```

#### お申し込みフォームをテスト

1. `/order` ページからテスト申し込みを送信
2. メールを確認
3. 以下が表示されているか確認：
   ```
   【電究社】WEB制作お申し込み - ○○様より
   
   フォームタイプ: WEB制作お申し込み
   
   【WEB制作お申し込み】
   会社名・屋号: ○○
   ご担当者名: ○○
   メールアドレス: ○○
   電話番号: ○○
   
   業種: ○○
   サイトの目的: ○○○○
   デザインイメージ: ○○
   
   必要なページ: ○○, ○○
   概算ページ数: ○○
   
   必要な機能: ○○
   
   ご予算: ○○
   希望納期: ○○
   
   参考サイト（URL）: ○○
   その他ご要望・ご質問: ○○
   ```

---

## 📊 変数リファレンス

### お問い合わせフォーム用変数

| 変数名 | 説明 | 例 |
|--------|------|-----|
| `{{form_type}}` | フォームタイプ | お問い合わせ |
| `{{from_name}}` | お名前 | 山田 太郎 |
| `{{from_email}}` | メールアドレス | test@example.com |
| `{{company}}` | 会社名・団体名 | 株式会社〇〇 |
| `{{message}}` | お問い合わせ内容 | ウェブサイトについて... |

### お申し込みフォーム用変数

| 変数名 | 説明 | 例 |
|--------|------|-----|
| `{{form_type}}` | フォームタイプ | WEB制作お申し込み |
| `{{company_name}}` | 会社名・屋号 | 株式会社〇〇 |
| `{{person_name}}` | ご担当者名 | 山田 太郎 |
| `{{email}}` | メールアドレス | test@example.com |
| `{{phone}}` | 電話番号 | 03-1234-5678 |
| `{{industry}}` | 業種 | IT・通信 |
| `{{purpose}}` | サイトの目的 | 顧客獲得のため |
| `{{design_image}}` | デザインイメージ | モダン・洗練 |
| `{{page_count}}` | 概算ページ数 | 約10ページ |
| `{{pages}}` | 必要なページ | トップページ, 会社概要 |
| `{{features}}` | 必要な機能 | お問い合わせフォーム |
| `{{budget}}` | ご予算 | 30万円〜50万円 |
| `{{deadline}}` | 希望納期 | 2024年6月末 |
| `{{reference_urls}}` | 参考サイト | https://... |
| `{{other_requests}}` | その他ご要望 | ○○をお願いします |

---

## 🔍 EmailJSの条件分岐構文

EmailJSでは、以下のように条件分岐ができます：

```
{{#変数名}}
  この部分は変数が存在する場合のみ表示されます
{{/変数名}}
```

**例:**
```
{{#company_name}}
会社名: {{company_name}}
{{/company_name}}
```

- お申し込みフォームの場合: `company_name`が存在するので表示される
- お問い合わせフォームの場合: `company_name`が存在しないので表示されない

---

## ✅ 確認ポイント

テンプレート更新後、以下を確認してください：

- [ ] 件名に`{{form_type}}`が含まれている
- [ ] 本文で条件分岐（`{{#company_name}}`など）を使用している
- [ ] お問い合わせフォーム用の変数（`{{from_name}}`等）が含まれている
- [ ] お申し込みフォーム用の変数（`{{company_name}}`等）が含まれている
- [ ] テンプレートを保存した
- [ ] テスト送信で内容が正しく表示される

---

## 🎯 簡易版テンプレート（最小構成）

もっとシンプルなテンプレートが良い場合は、こちらを使用してください：

### 件名
```
【電究社】新しい{{form_type}}
```

### 本文
```
電究社へ{{form_type}}がありました。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{{#from_name}}
■ お問い合わせ

お名前: {{from_name}}
メールアドレス: {{from_email}}
会社名: {{company}}

お問い合わせ内容:
{{message}}
{{/from_name}}

{{#company_name}}
■ WEB制作お申し込み

会社名: {{company_name}}
担当者: {{person_name}}
メールアドレス: {{email}}
電話番号: {{phone}}

業種: {{industry}}
目的: {{purpose}}
デザイン: {{design_image}}

ページ: {{pages}}
ページ数: {{page_count}}
機能: {{features}}

予算: {{budget}}
納期: {{deadline}}

参考サイト: {{reference_urls}}
その他: {{other_requests}}
{{/company_name}}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 📸 スクリーンショット付き手順（参考）

### 1. Email Templatesページ
<img src="https://www.emailjs.com/docs/assets/images/dashboard-templates.png" alt="Email Templates" width="600">

### 2. テンプレート編集画面
- 左側: 件名と本文を編集
- 右側: プレビュー
- 変数は `{{変数名}}` の形式で記述

### 3. 保存ボタン
- 編集後、必ず**Save**ボタンをクリック

---

## ⚠️ よくある間違い

### 間違い1: 中括弧の数が足りない
❌ `{from_name}`  
✅ `{{from_name}}`

### 間違い2: 変数名のスペルミス
❌ `{{companyname}}`  
✅ `{{company_name}}`

### 間違い3: 条件分岐の閉じタグがない
❌ `{{#company_name}} 会社名: {{company_name}}`  
✅ `{{#company_name}} 会社名: {{company_name}} {{/company_name}}`

---

## 🆘 トラブルシューティング

### Q: テンプレートを更新したが、まだ古いメールが届く

**A:** ブラウザのキャッシュをクリアするか、別のブラウザで試してください。EmailJS側のキャッシュが原因の場合は、数分待ってから再度テストしてください。

### Q: 一部の変数だけ表示されない

**A:** 変数名のスペルを確認してください。コンソールログ（`📤 EmailJS送信中...`）に表示されている変数名と完全に一致している必要があります。

### Q: 条件分岐が動作しない

**A:** 以下を確認してください：
1. `{{#変数名}}`と`{{/変数名}}`が両方記述されているか
2. 変数名が完全に一致しているか
3. 変数名にスペースが入っていないか

---

**作成日:** 2026年1月18日  
**対象:** 電究社 WEBサイト  
**テンプレートID:** template_vffjunb  
**問題:** メールは届くが内容が空白
