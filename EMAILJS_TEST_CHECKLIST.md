# EmailJS 動作確認チェックリスト

このチェックリストに従って、フォームが正しく動作しているか確認してください。

---

## ⚡ クイックテスト

### ステップ1: 開発サーバーの再起動

```bash
# 開発サーバーを停止して再起動
npm run dev
```

> **重要:** 環境変数やEmailJS設定を変更した場合は、必ず開発サーバーを再起動してください。

---

### ステップ2: ブラウザの開発者ツールを開く

1. ブラウザでサイトを開く
2. **F12キー**を押す（または右クリック → 「検証」）
3. **Console**タブを選択

---

### ステップ3: 初期化ログを確認

ページを読み込むと、コンソールに以下のログが表示されるはずです：

```javascript
EmailJS Config: {
  serviceId: "service_okm53ng",
  contactTemplateId: "template_vffjunb",
  orderTemplateId: "template_vffjunb",
  publicKey: "設定済み"
}
```

✅ **このログが表示されている** → EmailJS設定は正しく読み込まれています  
❌ **このログが表示されていない** → 開発サーバーを再起動してください

---

## 📝 お問い合わせフォームのテスト

### ステップ1: お問い合わせフォームにアクセス

1. トップページにアクセス
2. 下にスクロールして「お問い合わせ」セクションを表示

### ステップ2: テストデータを入力

- **お名前:** テスト太郎
- **メールアドレス:** test@example.com
- **会社名・団体名:** テスト株式会社
- **お問い合わせ内容:** これはテストメッセージです

### ステップ3: 送信ボタンをクリック

### ステップ4: コンソールログを確認

以下のログが順番に表示されるはずです：

```
✅ 成功パターン:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📧 フォーム送信開始
送信データ: {name: "テスト太郎", email: "test@example.com", ...}
EmailJS設定: {
  serviceId: "service_okm53ng",
  templateId: "template_vffjunb",
  publicKey: "設定済み"
}
📤 EmailJS送信中... {
  form_type: "お問い合わせ",
  from_name: "テスト太郎",
  from_email: "test@example.com",
  company: "テスト株式会社",
  message: "これはテストメッセージです"
}
✅ EmailJS送信結果: {status: 200, text: "OK"}
🎉 メール送信成功！
📧 フォーム送信処理完了
━━━━━━━━━━━━━━━━━━━━━━━━━━━━

❌ エラーパターン:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📧 フォーム送信開始
...
❌ 送信エラー: Error: ...
エラーメッセージ: ...
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### ステップ5: 成功メッセージの確認

送信が成功すると、アラートが表示されます：
```
お問い合わせありがとうございます。後ほどご連絡させていただきます。
```

---

## 🛒 お申し込みフォームのテスト

### ステップ1: お申し込みフォームにアクセス

1. ブラウザで `/order` にアクセス
2. または CREATEページから「お申し込みはこちら」をクリック

### ステップ2: テストデータを入力

**基本情報:**
- **会社名・屋号:** テスト株式会社
- **ご担当者名:** テスト太郎
- **メールアドレス:** test@example.com
- **電話番号:** 03-1234-5678

**サイト情報:**
- **業種:** IT・通信
- **サイトの目的:** テストのため
- **デザインイメージ:** モダン・洗練

**ページ構成:**
- **必要なページ:** トップページ、会社概要・自己紹介 にチェック
- **概算ページ数:** 約10ページ

**機能要件:**
- **必要な機能:** お問い合わせフォーム にチェック

**予算・スケジュール:**
- **ご予算:** 30万円〜50万円

### ステップ3: 送信ボタンをクリック

### ステップ4: コンソールログを確認

以下のログが順番に表示されるはずです：

```
✅ 成功パターン:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📧 お申し込みフォーム送信開始
送信データ: {companyName: "テスト株式会社", personName: "テスト太郎", ...}
EmailJS設定: {
  serviceId: "service_okm53ng",
  templateId: "template_vffjunb",
  publicKey: "設定済み"
}
📤 EmailJS送信中... {
  form_type: "WEB制作お申し込み",
  company_name: "テスト株式会社",
  person_name: "テスト太郎",
  email: "test@example.com",
  phone: "03-1234-5678",
  industry: "IT・通信",
  purpose: "テストのため",
  design_image: "モダン・洗練",
  page_count: "約10ページ",
  pages: "top, about",
  features: "contactForm",
  budget: "30万円〜50万円",
  deadline: "未入力",
  reference_urls: "未入力",
  other_requests: "未入力"
}
✅ EmailJS送信結果: {status: 200, text: "OK"}
🎉 お申し込みメール送信成功！
📧 お申し込みフォーム送信処理完了
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### ステップ5: 成功画面の確認

送信が成功すると、画面が切り替わり以下が表示されます：
- ✅ 緑のチェックマーク
- 「お申し込みありがとうございます」
- 「3営業日以内にご連絡させていただきます」

---

## 🔍 EmailJS ダッシュボードで確認

### ステップ1: EmailJSにログイン

[EmailJS Dashboard](https://dashboard.emailjs.com/) にアクセス

### ステップ2: Activityログを確認

1. 左側メニューから **Activity** をクリック
2. 送信履歴を確認

**確認ポイント:**
- ✅ お問い合わせフォームの送信履歴がある
- ✅ お申し込みフォームの送信履歴がある
- ✅ Status が "Sent" になっている
- ✅ 送信時刻が正しい

### ステップ3: Template Parameters を確認

各送信履歴をクリックして、送信されたデータを確認：

**お問い合わせフォーム:**
- `form_type: "お問い合わせ"`
- `from_name`, `from_email`, `company`, `message`

**お申し込みフォーム:**
- `form_type: "WEB制作お申し込み"`
- `company_name`, `person_name`, `email`, `phone`, `industry`, etc.

---

## 📬 メールボックスで確認

### ステップ1: 受信メールを確認

EmailJSのEmail Serviceで設定したメールアドレスを確認

### ステップ2: 届いていない場合

1. **迷惑メールフォルダ**を確認
2. **プロモーションタブ**（Gmailの場合）を確認
3. EmailJSの Email Service 設定を確認

### ステップ3: メールの内容を確認

受信したメールに以下が含まれているか確認：

**お問い合わせフォーム:**
- 件名に「お問い合わせ」が含まれている
- `{{from_name}}`, `{{from_email}}`, `{{company}}`, `{{message}}`の値が正しく表示されている

**お申し込みフォーム:**
- 件名に「WEB制作お申し込み」が含まれている
- すべての入力データが正しく表示されている

---

## ⚠️ トラブルシューティング

### 問題1: コンソールに初期化ログが表示されない

**原因:** 開発サーバーが環境変数を読み込んでいない

**解決策:**
1. 開発サーバーを完全に停止（Ctrl+C）
2. `npm run dev` で再起動
3. ブラウザをリロード

---

### 問題2: "EmailJS Public Key is not set" エラー

**原因:** Public Keyが設定されていない

**解決策:**
1. `/src/config/emailjs.ts` を確認
2. `publicKey` のフォールバック値（`'e-GUfAZt_TrCL8nGB'`）が設定されているか確認
3. 開発サーバーを再起動

---

### 問題3: コンソールに "❌ 送信エラー: Error 401" が表示される

**原因:** Service ID、Template ID、またはPublic Keyが間違っている

**解決策:**
1. [EmailJS Dashboard](https://dashboard.emailjs.com/) にログイン
2. **Account** → **General** で Public Key を確認
3. **Email Services** で Service ID を確認
4. **Email Templates** で Template ID を確認
5. `/src/config/emailjs.ts` のフォールバック値を確認
6. 値が一致しているか確認
7. 開発サーバーを再起動

---

### 問題4: EmailJS Activityに履歴はあるが、メールが届かない

**原因:** Email Serviceの設定に問題がある

**解決策:**
1. EmailJS Dashboard → **Email Services** を確認
2. 使用しているEmail Serviceをクリック
3. **Test Connection** ボタンをクリック
4. テストメールが届くか確認
5. 届かない場合は、Email Serviceを再接続

---

### 問題5: 送信ボタンをクリックしても何も起こらない

**原因:** JavaScript エラーが発生している

**解決策:**
1. ブラウザのコンソールを確認
2. 赤いエラーメッセージがないか確認
3. エラーがある場合、そのメッセージを確認
4. 必要なパッケージがインストールされているか確認：
   ```bash
   npm install @emailjs/browser react-hook-form
   ```

---

## ✅ 確認完了チェックリスト

動作確認が完了したら、以下をチェックしてください：

- [ ] 開発サーバーを再起動した
- [ ] コンソールに初期化ログが表示される
- [ ] **お問い合わせフォーム**をテストし、成功メッセージが表示された
- [ ] コンソールに `form_type: "お問い合わせ"` が表示された
- [ ] **お申し込みフォーム**をテストし、成功画面が表示された
- [ ] コンソールに `form_type: "WEB制作お申し込み"` が表示された
- [ ] EmailJS Activityに2つの送信履歴が表示されている
- [ ] 2つのメールがメールボックスに届いている
- [ ] メールの内容が正しく表示されている

---

## 📊 動作確認結果

テスト実施日: ___________

### お問い合わせフォーム
- [ ] ✅ 正常に動作
- [ ] ❌ エラーが発生（エラー内容: ________________）

### お申し込みフォーム
- [ ] ✅ 正常に動作
- [ ] ❌ エラーが発生（エラー内容: ________________）

### EmailJS Activity
- [ ] ✅ 送信履歴が表示される
- [ ] ❌ 送信履歴が表示されない

### メール受信
- [ ] ✅ メールが届いている
- [ ] ❌ メールが届いていない（迷惑メールフォルダも確認済み）

---

## 🎯 次のステップ

すべてのチェックが完了したら：

1. **EmailJSのテンプレートをカスタマイズ**
   - 件名や本文を会社のブランドに合わせて調整
   - `/EMAILJS_SETUP_GUIDE.md` を参照

2. **本番環境に環境変数を設定**
   - デプロイ先（Netlify、Vercel等）に環境変数を追加

3. **実際の業務で使用開始**
   - テストメールを削除
   - 実際のお問い合わせに対応

---

## 📞 サポート

問題が解決しない場合：

1. ブラウザのコンソールログのスクリーンショットを撮る
2. EmailJS Activity画面のスクリーンショットを撮る
3. どのステップでエラーが発生したかをメモする
4. [EmailJS Support](https://www.emailjs.com/docs/) を参照

---

**作成日:** 2026年1月18日  
**対象:** 電究社 WEBサイト  
**EmailJS Service ID:** service_okm53ng
